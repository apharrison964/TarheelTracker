<div class="paperscript">
<div class="source hidden" style="border-width: 0px 0px 0px 1px; width: 1215px; height: 828px;"><div class="CodeMirror"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 154px; left: 208px;"><textarea wrap="off" autocorrect="off" autocapitalize="off" style="position: absolute; padding: 0px; width: 1px; height: 1em;"></textarea></div><div class="CodeMirror-scrollbar" style="z-index: -2; visibility: hidden; display: none;"><div class="CodeMirror-scrollbar-inner"></div></div><div class="CodeMirror-scroll cm-s-default" tabindex="-1" draggable="false"><div style="position: relative;"><div style="position: relative; top: 0px;"><div class="CodeMirror-gutter" style="height: 1550px;"><div class="CodeMirror-gutter-text"><pre>1</pre><pre>2</pre><pre>3</pre><pre>4</pre><pre>5</pre><pre>6</pre><pre>7</pre><pre>8</pre><pre>9</pre><pre>10</pre><pre>11</pre><pre>12</pre><pre>13</pre><pre>14</pre><pre>15</pre><pre>16</pre><pre>17</pre><pre>18</pre><pre>19</pre><pre>20</pre><pre>21</pre><pre>22</pre><pre>23</pre><pre>24</pre><pre>25</pre><pre>26</pre><pre>27</pre><pre>28</pre><pre>29</pre><pre>30</pre><pre>31</pre><pre>32</pre><pre>33</pre><pre>34</pre><pre>35</pre><pre>36</pre><pre>37</pre><pre>38</pre><pre>39</pre><pre>40</pre><pre>41</pre><pre>42</pre><pre>43</pre><pre>44</pre><pre>45</pre><pre>46</pre><pre>47</pre><pre>48</pre><pre>49</pre><pre>50</pre><pre>51</pre><pre>52</pre><pre>53</pre><pre>54</pre><pre>55</pre><pre>56</pre><pre>57</pre><pre>58</pre><pre>59</pre><pre>60</pre><pre>61</pre><pre>62</pre><pre>63</pre><pre>64</pre><pre>65</pre><pre>66</pre><pre>67</pre><pre>68</pre><pre>69</pre><pre>70</pre><pre>71</pre><pre>72</pre><pre>73</pre><pre>74</pre><pre>75</pre><pre>76</pre><pre>77</pre><pre>78</pre><pre>79</pre><pre>80</pre><pre>81</pre><pre>82</pre><pre>83</pre><pre>84</pre><pre>85</pre></div></div><div class="CodeMirror-lines"><div style="position: relative; z-index: 0; outline: none; min-width: 597px; margin-left: 31px;"><div style="position: absolute; width: 100%; height: 0px; overflow: hidden; visibility: hidden;"><pre><span class="cm-tab">    </span><span class="cm-variable-2">this</span>.<span class="cm-property">gravity</span> = <span class="cm-number">3</span>;<span> </span></pre></div><pre class="CodeMirror-cursor" style="top: 144px; left: 169px; visibility: hidden;">&nbsp;</pre><pre class="CodeMirror-cursor" style="visibility: hidden; left: 588px;">&nbsp;</pre>\<div style="position: relative; z-index: -1; display: none;"><div class="CodeMirror-selected" style="position: absolute; left: 0px; top: 0px; right: -1px; height: 1512px;"></div>\<div class="CodeMirror-selected" style="position: absolute; left: 0px; top: 1512px; right: 1167px; height: 18px;"></div></div><div><pre><span class="cm-keyword">var</span> <span class="cm-variable">Ball</span> = <span class="cm-keyword">function</span>(<span class="cm-def">point</span>, <span class="cm-def">vector</span>) {</pre><pre><span class="cm-tab">    </span><span class="cm-keyword">if</span> (!<span class="cm-variable-2">vector</span> || <span class="cm-variable-2">vector</span>.<span class="cm-variable">isZero</span>()) {</pre><pre><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-variable-2">this</span>.<span class="cm-property">vector</span> = <span class="cm-variable">Point</span>.<span class="cm-property">random</span>() * <span class="cm-number">5</span>;</pre><pre><span class="cm-tab">    </span>} <span class="cm-keyword">else</span> {</pre><pre><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-variable-2">this</span>.<span class="cm-property">vector</span> = <span class="cm-variable-2">vector</span> * <span class="cm-number">2</span>;</pre><pre><span class="cm-tab">    </span>}</pre><pre><span class="cm-tab">    </span><span class="cm-variable-2">this</span>.<span class="cm-property">point</span> = <span class="cm-variable-2">point</span>;</pre><pre><span class="cm-tab">    </span><span class="cm-variable-2">this</span>.<span class="cm-property">dampen</span> = <span class="cm-number">0.4</span>;</pre><pre><span class="cm-tab">    </span><span class="cm-variable-2">this</span>.<span class="cm-property">gravity</span> = <span class="cm-number">3</span>;</pre><pre><span class="cm-tab">    </span><span class="cm-variable-2">this</span>.<span class="cm-property">bounce</span> = <span class="cm-number">-0.6</span>;</pre><pre> </pre><pre><span class="cm-tab">    </span><span class="cm-keyword">var</span> <span class="cm-def">color</span> = {</pre><pre><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-property">hue</span>: <span class="cm-number">35</span>,</pre><pre><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-property">saturation</span>: <span class="cm-number">1</span>,</pre><pre><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-property">brightness</span>: <span class="cm-number">1</span></pre><pre><span class="cm-tab">    </span>};</pre><pre><span class="cm-tab">    </span><span class="cm-keyword">var</span> <span class="cm-def">gradient</span> = <span class="cm-keyword">new</span> <span class="cm-variable">Gradient</span>([<span class="cm-variable-2">color</span>, <span class="cm-string">'black'</span>], <span class="cm-atom">true</span>);</pre><pre> </pre><pre><span class="cm-tab">    </span><span class="cm-keyword">var</span> <span class="cm-def">radius</span> = <span class="cm-variable-2">this</span>.<span class="cm-property">radius</span> = <span class="cm-number">50</span>;</pre><pre><span class="cm-tab">    </span><span class="cm-comment">// Wrap CompoundPath in a Group, since CompoundPaths directly </span></pre><pre><span class="cm-tab">    </span><span class="cm-comment">// applies the transformations to the content, just like Path.</span></pre><pre><span class="cm-tab">    </span><span class="cm-keyword">var</span> <span class="cm-def">ball</span> = <span class="cm-keyword">new</span> <span class="cm-variable">CompoundPath</span>({</pre><pre><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-property">children</span>: [</pre><pre><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-keyword">new</span> <span class="cm-variable">Path</span>.<span class="cm-property">Circle</span>({</pre><pre><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-property">radius</span>: <span class="cm-variable-2">radius</span></pre><pre><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span>})</pre><pre><span class="cm-tab">    </span><span class="cm-tab">    </span>],</pre><pre><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-property">fillColor</span>: <span class="cm-keyword">new</span> <span class="cm-variable">Color</span>(<span class="cm-variable-2">gradient</span>, <span class="cm-number">0</span>, <span class="cm-variable-2">radius</span>, <span class="cm-variable-2">radius</span> / <span class="cm-number">8</span>),</pre><pre><span class="cm-tab">    </span>});</pre><pre> </pre><pre><span class="cm-tab">    </span><span class="cm-variable-2">this</span>.<span class="cm-property">item</span> = <span class="cm-keyword">new</span> <span class="cm-variable">Group</span>({</pre><pre><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-property">children</span>: [<span class="cm-variable-2">ball</span>],</pre><pre><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-property">transformContent</span>: <span class="cm-atom">false</span>,</pre><pre><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-property">position</span>: <span class="cm-variable-2">this</span>.<span class="cm-property">point</span></pre><pre><span class="cm-tab">    </span>});</pre><pre>}</pre><pre> </pre><pre><span class="cm-variable">Ball</span>.<span class="cm-property">prototype</span>.<span class="cm-property">iterate</span> = <span class="cm-keyword">function</span>() {</pre><pre><span class="cm-tab">    </span><span class="cm-keyword">var</span> <span class="cm-def">size</span> = <span class="cm-variable">view</span>.<span class="cm-property">size</span>;</pre><pre><span class="cm-tab">    </span><span class="cm-variable-2">this</span>.<span class="cm-property">vector</span>.<span class="cm-property">y</span> += <span class="cm-variable-2">this</span>.<span class="cm-property">gravity</span>;</pre><pre><span class="cm-tab">    </span><span class="cm-variable-2">this</span>.<span class="cm-property">vector</span>.<span class="cm-property">x</span> *= <span class="cm-number">0.99</span>;</pre><pre><span class="cm-tab">    </span><span class="cm-keyword">var</span> <span class="cm-def">pre</span> = <span class="cm-variable-2">this</span>.<span class="cm-property">point</span> + <span class="cm-variable-2">this</span>.<span class="cm-property">vector</span>;</pre><pre><span class="cm-tab">    </span><span class="cm-keyword">if</span> (<span class="cm-variable-2">pre</span>.<span class="cm-property">x</span> &lt; <span class="cm-variable-2">this</span>.<span class="cm-variable">radius</span> || <span class="cm-variable-2">pre</span>.<span class="cm-variable">x</span> &gt; <span class="cm-variable-2">size</span>.<span class="cm-variable">width</span> - <span class="cm-variable-2">this</span>.<span class="cm-variable">radius</span>)</pre><pre><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-variable-2">this</span>.<span class="cm-property">vector</span>.<span class="cm-property">x</span> *= -<span class="cm-variable-2">this</span>.<span class="cm-property">dampen</span>;</pre><pre><span class="cm-tab">    </span><span class="cm-keyword">if</span> (<span class="cm-variable-2">pre</span>.<span class="cm-property">y</span> &lt; <span class="cm-variable-2">this</span>.<span class="cm-variable">radius</span> || <span class="cm-variable-2">pre</span>.<span class="cm-variable">y</span> &gt; <span class="cm-variable-2">size</span>.<span class="cm-variable">height</span> - <span class="cm-variable-2">this</span>.<span class="cm-variable">radius</span>) {</pre><pre><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-keyword">if</span> (<span class="cm-variable">Math</span>.<span class="cm-property">abs</span>(<span class="cm-variable-2">this</span>.<span class="cm-property">vector</span>.<span class="cm-property">x</span>) &lt; <span class="cm-number">3</span>)</pre><pre><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-variable-2">this</span>.<span class="cm-property">vector</span> = <span class="cm-variable">Point</span>.<span class="cm-property">random</span>() * [<span class="cm-number">150</span>, <span class="cm-number">100</span>] + [<span class="cm-number">-75</span>, <span class="cm-number">20</span>];</pre><pre><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-variable-2">this</span>.<span class="cm-property">vector</span>.<span class="cm-property">y</span> *= <span class="cm-variable-2">this</span>.<span class="cm-property">bounce</span>;</pre><pre><span class="cm-tab">    </span>}</pre><pre> </pre><pre><span class="cm-tab">    </span><span class="cm-keyword">var</span> <span class="cm-def">max</span> = <span class="cm-variable">Point</span>.<span class="cm-property">max</span>(<span class="cm-variable-2">this</span>.<span class="cm-property">radius</span>, <span class="cm-variable-2">this</span>.<span class="cm-property">point</span> + <span class="cm-variable-2">this</span>.<span class="cm-variable">vector</span>);</pre><pre><span class="cm-tab">    </span><span class="cm-variable-2">this</span>.<span class="cm-property">item</span>.<span class="cm-property">position</span> = <span class="cm-variable-2">this</span>.<span class="cm-property">point</span> = <span class="cm-variable">Point</span>.<span class="cm-property">min</span>(<span class="cm-variable-2">max</span>, <span class="cm-variable-2">size</span> - <span class="cm-variable-2">this</span>.<span class="cm-variable">radius</span>);</pre><pre><span class="cm-tab">    </span><span class="cm-variable-2">this</span>.<span class="cm-property">item</span>.<span class="cm-property">rotate</span>(<span class="cm-variable-2">this</span>.<span class="cm-property">vector</span>.<span class="cm-property">x</span>);</pre><pre>};</pre><pre> </pre><pre> </pre><pre><span class="cm-keyword">var</span> <span class="cm-variable">balls</span> = [];</pre><pre><span class="cm-keyword">for</span> (<span class="cm-keyword">var</span> <span class="cm-variable">i</span> = <span class="cm-number">0</span>; <span class="cm-variable">i</span> &lt; <span class="cm-number">10</span>; <span class="cm-variable">i</span>++) {</pre><pre><span class="cm-tab">    </span><span class="cm-keyword">var</span> <span class="cm-variable">position</span> = <span class="cm-variable">Point</span>.<span class="cm-property">random</span>() * <span class="cm-variable">view</span>.<span class="cm-property">size</span>,</pre><pre><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-variable">vector</span> = (<span class="cm-variable">Point</span>.<span class="cm-property">random</span>() - [<span class="cm-number">0.5</span>, <span class="cm-number">0</span>]) * [<span class="cm-number">50</span>, <span class="cm-number">100</span>],</pre><pre><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-variable">ball</span> = <span class="cm-keyword">new</span> <span class="cm-variable">Ball</span>(<span class="cm-variable">position</span>, <span class="cm-variable">vector</span>);</pre><pre><span class="cm-tab">    </span><span class="cm-variable">balls</span>.<span class="cm-property">push</span>(<span class="cm-variable">ball</span>);</pre><pre>}</pre><pre> </pre><pre><span class="cm-keyword">var</span> <span class="cm-variable">textItem</span> = <span class="cm-keyword">new</span> <span class="cm-variable">PointText</span>({</pre><pre><span class="cm-tab">    </span><span class="cm-property">point</span>: [<span class="cm-number">20</span>, <span class="cm-number">30</span>],</pre><pre><span class="cm-tab">    </span><span class="cm-property">fillColor</span>: <span class="cm-string">'black'</span>,</pre><pre><span class="cm-tab">    </span><span class="cm-property">content</span>: <span class="cm-string">'Click, drag and release to add balls.'</span></pre><pre>});</pre><pre> </pre><pre><span class="cm-keyword">var</span> <span class="cm-variable">lastDelta</span>;</pre><pre><span class="cm-keyword">function</span> <span class="cm-variable">onMouseDrag</span>(<span class="cm-def">event</span>) {</pre><pre><span class="cm-tab">    </span><span class="cm-variable">lastDelta</span> = <span class="cm-variable-2">event</span>.<span class="cm-property">delta</span>;</pre><pre>}</pre><pre> </pre><pre><span class="cm-keyword">function</span> <span class="cm-variable">onMouseUp</span>(<span class="cm-def">event</span>) {</pre><pre><span class="cm-tab">    </span><span class="cm-keyword">var</span> <span class="cm-def">ball</span> = <span class="cm-keyword">new</span> <span class="cm-variable">Ball</span>(<span class="cm-variable-2">event</span>.<span class="cm-property">point</span>, <span class="cm-variable">lastDelta</span>);</pre><pre><span class="cm-tab">    </span><span class="cm-variable">balls</span>.<span class="cm-property">push</span>(<span class="cm-variable-2">ball</span>);</pre><pre><span class="cm-tab">    </span><span class="cm-variable">lastDelta</span> = <span class="cm-atom">null</span>;</pre><pre>}</pre><pre> </pre><pre><span class="cm-keyword">function</span> <span class="cm-variable">onFrame</span>() {</pre><pre><span class="cm-tab">    </span><span class="cm-keyword">for</span> (<span class="cm-keyword">var</span> <span class="cm-def">i</span> = <span class="cm-number">0</span>, <span class="cm-def">l</span> = <span class="cm-variable">balls</span>.<span class="cm-property">length</span>; <span class="cm-variable-2">i</span> &lt; <span class="cm-variable-2">l</span>; <span class="cm-variable-2">i</span>++)</pre><pre><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-variable">balls</span>[<span class="cm-variable-2">i</span>].<span class="cm-property">iterate</span>();</pre><pre>}</pre></div></div></div></div></div></div></div></div>
<script type="text/paperscript" canvas="canvas-1" data-paper-ignore="true">


<!-- bouncing balls -->


<div class="paperscript">
<div class="source hidden" style="border-width: 0px 0px 0px 1px; width: 1215px; height: 828px;">
	<div class="CodeMirror"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 154px; left: 208px;">
		<textarea wrap="off" autocorrect="off" autocapitalize="off" style="position: absolute; padding: 0px; width: 1px; height: 1em;"></textarea>
	</div>
	<div class="CodeMirror-scrollbar" style="z-index: -2; visibility: hidden; display: none;">
		<div class="CodeMirror-scrollbar-inner"></div>
	</div>
	<div class="CodeMirror-scroll cm-s-default" tabindex="-1" draggable="false">
		<div style="position: relative;">
				<div style="position: relative; top: 0px;">
					<div class="CodeMirror-gutter" style="height: 1550px;">
						<div class="CodeMirror-gutter-text">
							<pre>1</pre>
							<pre>2</pre>
							<pre>3</pre>
							<pre>4</pre>
							<pre>5</pre>
							<pre>6</pre>
							<pre>7</pre>
							<pre>8</pre>
							<pre>9</pre>
							<pre>10</pre>
							<pre>11</pre>
							<pre>12</pre>
							<pre>13</pre>
							<pre>14</pre>
							<pre>15</pre>
							<pre>16</pre>
							<pre>17</pre>
							<pre>18</pre>
							<pre>19</pre>
							<pre>20</pre>
							<pre>21</pre>
							<pre>22</pre>
							<pre>23</pre>
							<pre>24</pre>
							<pre>25</pre>
							<pre>26</pre>
							<pre>27</pre>
							<pre>28</pre>
							<pre>29</pre>
							<pre>30</pre>
							<pre>31</pre>
							<pre>32</pre>
							<pre>33</pre>
							<pre>34</pre>
							<pre>35</pre>
							<pre>36</pre>
							<pre>37</pre>
							<pre>38</pre>
							<pre>39</pre>
							<pre>40</pre><pre>41</pre><pre>42</pre><pre>43</pre><pre>44</pre><pre>45</pre><pre>46</pre><pre>47</pre><pre>48</pre><pre>49</pre><pre>50</pre><pre>51</pre><pre>52</pre><pre>53</pre><pre>54</pre><pre>55</pre><pre>56</pre><pre>57</pre><pre>58</pre><pre>59</pre><pre>60</pre><pre>61</pre><pre>62</pre><pre>63</pre><pre>64</pre><pre>65</pre><pre>66</pre><pre>67</pre><pre>68</pre><pre>69</pre><pre>70</pre><pre>71</pre><pre>72</pre><pre>73</pre><pre>74</pre><pre>75</pre><pre>76</pre><pre>77</pre><pre>78</pre><pre>79</pre><pre>80</pre><pre>81</pre><pre>82</pre><pre>83</pre><pre>84</pre><pre>85</pre>
						</div>
					</div>
					<div class="CodeMirror-lines">
						<div style="position: relative; z-index: 0; outline: none; min-width: 597px; margin-left: 31px;">
							<div style="position: absolute; width: 100%; height: 0px; overflow: hidden; visibility: hidden;">
								<pre>
									<span class="cm-tab">    </span>
									<span class="cm-variable-2">this</span>.
									<span class="cm-property">gravity</span> = 
									<span class="cm-number">3</span>;
									<span> </span>
								</pre>
							</div>
							<pre class="CodeMirror-cursor" style="top: 144px; left: 169px; visibility: hidden;">&nbsp;</pre>
							<pre class="CodeMirror-cursor" style="visibility: hidden; left: 588px;">&nbsp;</pre>
							<div style="position: relative; z-index: -1; display: none;">
								<div class="CodeMirror-selected" style="position: absolute; left: 0px; top: 0px; right: -1px; height: 1512px;"></div>
								<div class="CodeMirror-selected" style="position: absolute; left: 0px; top: 1512px; right: 1167px; height: 18px;"></div>
							</div>
							<div>
								<pre>
									<span class="cm-keyword">var</span> 
									<span class="cm-variable">Ball</span> = 
									<span class="cm-keyword">function</span>(
									<span class="cm-def">point</span>, 
									<span class="cm-def">vector</span>) {
									</pre><pre><span class="cm-tab">    </span>
									<span class="cm-keyword">if</span> (!
									<span class="cm-variable-2">vector</span> || 
									<span class="cm-variable-2">vector</span>.
									<span class="cm-variable">isZero</span>()) {
									</pre><pre><span class="cm-tab">    </span>
									<span class="cm-tab">    </span>
									<span class="cm-variable-2">this</span>.
									<span class="cm-property">vector</span> = 
									<span class="cm-variable">Point</span>.
									<span class="cm-property">random</span>() * 
									<span class="cm-number">5</span>;
								</pre>
								<pre><span class="cm-tab">    </span>} <span class="cm-keyword">else</span> {</pre><pre><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-variable-2">this</span>.<span class="cm-property">vector</span> = <span class="cm-variable-2">vector</span> * <span class="cm-number">2</span>;</pre><pre><span class="cm-tab">    </span>}</pre><pre><span class="cm-tab">    </span><span class="cm-variable-2">this</span>.<span class="cm-property">point</span> = <span class="cm-variable-2">point</span>;</pre><pre><span class="cm-tab">    </span><span class="cm-variable-2">this</span>.<span class="cm-property">dampen</span> = <span class="cm-number">0.4</span>;</pre><pre><span class="cm-tab">    </span><span class="cm-variable-2">this</span>.<span class="cm-property">gravity</span> = <span class="cm-number">3</span>;</pre><pre><span class="cm-tab">    </span><span class="cm-variable-2">this</span>.<span class="cm-property">bounce</span> = <span class="cm-number">-0.6</span>;</pre><pre> </pre><pre><span class="cm-tab">    </span><span class="cm-keyword">var</span> <span class="cm-def">color</span> = {</pre><pre><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-property">hue</span>: <span class="cm-number">35</span>,</pre><pre><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-property">saturation</span>: <span class="cm-number">1</span>,</pre><pre><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-property">brightness</span>: <span class="cm-number">1</span></pre><pre><span class="cm-tab">    </span>};</pre><pre><span class="cm-tab">    </span><span class="cm-keyword">var</span> <span class="cm-def">gradient</span> = <span class="cm-keyword">new</span> <span class="cm-variable">Gradient</span>([<span class="cm-variable-2">color</span>, <span class="cm-string">'black'</span>], <span class="cm-atom">true</span>);</pre><pre> </pre><pre><span class="cm-tab">    </span><span class="cm-keyword">var</span> <span class="cm-def">radius</span> = <span class="cm-variable-2">this</span>.<span class="cm-property">radius</span> = <span class="cm-number">50</span>;</pre><pre><span class="cm-tab">    </span><span class="cm-comment">// Wrap CompoundPath in a Group, since CompoundPaths directly </span></pre><pre><span class="cm-tab">    </span><span class="cm-comment">// applies the transformations to the content, just like Path.</span></pre><pre><span class="cm-tab">    </span><span class="cm-keyword">var</span> <span class="cm-def">ball</span> = <span class="cm-keyword">new</span> <span class="cm-variable">CompoundPath</span>({</pre><pre><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-property">children</span>: [</pre><pre><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-keyword">new</span> <span class="cm-variable">Path</span>.<span class="cm-property">Circle</span>({</pre><pre><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-property">radius</span>: <span class="cm-variable-2">radius</span></pre><pre><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span>})</pre><pre><span class="cm-tab">    </span><span class="cm-tab">    </span>],</pre><pre><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-property">fillColor</span>: <span class="cm-keyword">new</span> <span class="cm-variable">Color</span>(<span class="cm-variable-2">gradient</span>, <span class="cm-number">0</span>, <span class="cm-variable-2">radius</span>, <span class="cm-variable-2">radius</span> / <span class="cm-number">8</span>),</pre><pre><span class="cm-tab">    </span>});</pre><pre> </pre><pre><span class="cm-tab">    </span><span class="cm-variable-2">this</span>.<span class="cm-property">item</span> = <span class="cm-keyword">new</span> <span class="cm-variable">Group</span>({</pre><pre><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-property">children</span>: [<span class="cm-variable-2">ball</span>],</pre><pre><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-property">transformContent</span>: <span class="cm-atom">false</span>,</pre><pre><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-property">position</span>: <span class="cm-variable-2">this</span>.<span class="cm-property">point</span></pre><pre><span class="cm-tab">    </span>});</pre><pre>}</pre><pre> </pre><pre><span class="cm-variable">Ball</span>.<span class="cm-property">prototype</span>.<span class="cm-property">iterate</span> = <span class="cm-keyword">function</span>() {</pre><pre><span class="cm-tab">    </span><span class="cm-keyword">var</span> <span class="cm-def">size</span> = <span class="cm-variable">view</span>.<span class="cm-property">size</span>;</pre><pre><span class="cm-tab">    </span><span class="cm-variable-2">this</span>.<span class="cm-property">vector</span>.<span class="cm-property">y</span> += <span class="cm-variable-2">this</span>.<span class="cm-property">gravity</span>;</pre><pre><span class="cm-tab">    </span><span class="cm-variable-2">this</span>.<span class="cm-property">vector</span>.<span class="cm-property">x</span> *= <span class="cm-number">0.99</span>;</pre><pre><span class="cm-tab">    </span><span class="cm-keyword">var</span> <span class="cm-def">pre</span> = <span class="cm-variable-2">this</span>.<span class="cm-property">point</span> + <span class="cm-variable-2">this</span>.<span class="cm-property">vector</span>;</pre><pre><span class="cm-tab">    </span><span class="cm-keyword">if</span> (<span class="cm-variable-2">pre</span>.<span class="cm-property">x</span> &lt; <span class="cm-variable-2">this</span>.<span class="cm-variable">radius</span> || <span class="cm-variable-2">pre</span>.<span class="cm-variable">x</span> &gt; <span class="cm-variable-2">size</span>.<span class="cm-variable">width</span> - <span class="cm-variable-2">this</span>.<span class="cm-variable">radius</span>)</pre><pre><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-variable-2">this</span>.<span class="cm-property">vector</span>.<span class="cm-property">x</span> *= -<span class="cm-variable-2">this</span>.<span class="cm-property">dampen</span>;</pre><pre><span class="cm-tab">    </span><span class="cm-keyword">if</span> (<span class="cm-variable-2">pre</span>.<span class="cm-property">y</span> &lt; <span class="cm-variable-2">this</span>.<span class="cm-variable">radius</span> || <span class="cm-variable-2">pre</span>.<span class="cm-variable">y</span> &gt; <span class="cm-variable-2">size</span>.<span class="cm-variable">height</span> - <span class="cm-variable-2">this</span>.<span class="cm-variable">radius</span>) {</pre><pre><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-keyword">if</span> (<span class="cm-variable">Math</span>.<span class="cm-property">abs</span>(<span class="cm-variable-2">this</span>.<span class="cm-property">vector</span>.<span class="cm-property">x</span>) &lt; <span class="cm-number">3</span>)</pre><pre><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-variable-2">this</span>.<span class="cm-property">vector</span> = <span class="cm-variable">Point</span>.<span class="cm-property">random</span>() * [<span class="cm-number">150</span>, <span class="cm-number">100</span>] + [<span class="cm-number">-75</span>, <span class="cm-number">20</span>];</pre><pre><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-variable-2">this</span>.<span class="cm-property">vector</span>.<span class="cm-property">y</span> *= <span class="cm-variable-2">this</span>.<span class="cm-property">bounce</span>;</pre><pre><span class="cm-tab">    </span>}</pre><pre> </pre><pre><span class="cm-tab">    </span><span class="cm-keyword">var</span> <span class="cm-def">max</span> = <span class="cm-variable">Point</span>.<span class="cm-property">max</span>(<span class="cm-variable-2">this</span>.<span class="cm-property">radius</span>, <span class="cm-variable-2">this</span>.<span class="cm-property">point</span> + <span class="cm-variable-2">this</span>.<span class="cm-variable">vector</span>);</pre><pre><span class="cm-tab">    </span><span class="cm-variable-2">this</span>.<span class="cm-property">item</span>.<span class="cm-property">position</span> = <span class="cm-variable-2">this</span>.<span class="cm-property">point</span> = <span class="cm-variable">Point</span>.<span class="cm-property">min</span>(<span class="cm-variable-2">max</span>, <span class="cm-variable-2">size</span> - <span class="cm-variable-2">this</span>.<span class="cm-variable">radius</span>);</pre><pre><span class="cm-tab">    </span><span class="cm-variable-2">this</span>.<span class="cm-property">item</span>.<span class="cm-property">rotate</span>(<span class="cm-variable-2">this</span>.<span class="cm-property">vector</span>.<span class="cm-property">x</span>);</pre><pre>};</pre><pre> </pre><pre> </pre><pre><span class="cm-keyword">var</span> <span class="cm-variable">balls</span> = [];</pre><pre><span class="cm-keyword">for</span> (<span class="cm-keyword">var</span> <span class="cm-variable">i</span> = <span class="cm-number">0</span>; <span class="cm-variable">i</span> &lt; <span class="cm-number">10</span>; <span class="cm-variable">i</span>++) {</pre><pre><span class="cm-tab">    </span><span class="cm-keyword">var</span> <span class="cm-variable">position</span> = <span class="cm-variable">Point</span>.<span class="cm-property">random</span>() * <span class="cm-variable">view</span>.<span class="cm-property">size</span>,</pre><pre><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-variable">vector</span> = (<span class="cm-variable">Point</span>.<span class="cm-property">random</span>() - [<span class="cm-number">0.5</span>, <span class="cm-number">0</span>]) * [<span class="cm-number">50</span>, <span class="cm-number">100</span>],</pre><pre><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-variable">ball</span> = <span class="cm-keyword">new</span> <span class="cm-variable">Ball</span>(<span class="cm-variable">position</span>, <span class="cm-variable">vector</span>);</pre><pre><span class="cm-tab">    </span><span class="cm-variable">balls</span>.<span class="cm-property">push</span>(<span class="cm-variable">ball</span>);</pre><pre>}</pre><pre> </pre><pre><span class="cm-keyword">var</span> <span class="cm-variable">textItem</span> = <span class="cm-keyword">new</span> <span class="cm-variable">PointText</span>({</pre><pre><span class="cm-tab">    </span><span class="cm-property">point</span>: [<span class="cm-number">20</span>, <span class="cm-number">30</span>],</pre><pre><span class="cm-tab">    </span><span class="cm-property">fillColor</span>: <span class="cm-string">'black'</span>,</pre><pre><span class="cm-tab">    </span><span class="cm-property">content</span>: <span class="cm-string">'Click, drag and release to add balls.'</span></pre><pre>});</pre><pre> </pre><pre><span class="cm-keyword">var</span> <span class="cm-variable">lastDelta</span>;</pre><pre><span class="cm-keyword">function</span> <span class="cm-variable">onMouseDrag</span>(<span class="cm-def">event</span>) {</pre><pre><span class="cm-tab">    </span><span class="cm-variable">lastDelta</span> = <span class="cm-variable-2">event</span>.<span class="cm-property">delta</span>;</pre><pre>}</pre><pre> </pre><pre><span class="cm-keyword">function</span> <span class="cm-variable">onMouseUp</span>(<span class="cm-def">event</span>) {</pre><pre><span class="cm-tab">    </span><span class="cm-keyword">var</span> <span class="cm-def">ball</span> = <span class="cm-keyword">new</span> <span class="cm-variable">Ball</span>(<span class="cm-variable-2">event</span>.<span class="cm-property">point</span>, <span class="cm-variable">lastDelta</span>);</pre><pre><span class="cm-tab">    </span><span class="cm-variable">balls</span>.<span class="cm-property">push</span>(<span class="cm-variable-2">ball</span>);</pre><pre><span class="cm-tab">    </span><span class="cm-variable">lastDelta</span> = <span class="cm-atom">null</span>;</pre><pre>}</pre><pre> </pre><pre><span class="cm-keyword">function</span> <span class="cm-variable">onFrame</span>() {</pre><pre><span class="cm-tab">    </span><span class="cm-keyword">for</span> (<span class="cm-keyword">var</span> <span class="cm-def">i</span> = <span class="cm-number">0</span>, <span class="cm-def">l</span> = <span class="cm-variable">balls</span>.<span class="cm-property">length</span>; <span class="cm-variable-2">i</span> &lt; <span class="cm-variable-2">l</span>; <span class="cm-variable-2">i</span>++)</pre><pre><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-variable">balls</span>[<span class="cm-variable-2">i</span>].<span class="cm-property">iterate</span>();</pre><pre>}</pre></div></div></div></div></div></div></div> 
	</div>
	<script type="text/paperscript" canvas="canvas-1" data-paper-ignore="true">
	var Ball = function(point, vector) {
	if (!vector || vector.isZero()) {
		this.vector = Point.random() * 5;
	} else {
		this.vector = vector * 2;
	}
	this.point = point;
	this.dampen = 0.4;
	this.gravity = 3;
	this.bounce = -0.6;

	var color = {
		hue: 35,
		saturation: 1,
		brightness: 1
	};
	var gradient = new Gradient([color, 'black'], true);

	var radius = this.radius = 50;
	// Wrap CompoundPath in a Group, since CompoundPaths directly 
	// applies the transformations to the content, just like Path.
	var ball = new CompoundPath({
		children: [
			new Path.Circle({
				radius: radius
			})
		],
		fillColor: new Color(gradient, 0, radius, radius / 8),
	});

	this.item = new Group({
		children: [ball],
		transformContent: false,
		position: this.point
	});
}

Ball.prototype.iterate = function() {
	var size = view.size;
	this.vector.y += this.gravity;
	this.vector.x *= 0.99;
	var pre = this.point + this.vector;
	if (pre.x < this.radius || pre.x > size.width - this.radius)
		this.vector.x *= -this.dampen;
	if (pre.y < this.radius || pre.y > size.height - this.radius) {
		if (Math.abs(this.vector.x) < 3)
			this.vector = Point.random() * [150, 100] + [-75, 20];
		this.vector.y *= this.bounce;
	}

	var max = Point.max(this.radius, this.point + this.vector);
	this.item.position = this.point = Point.min(max, size - this.radius);
	this.item.rotate(this.vector.x);
};


var balls = [];
for (var i = 0; i < 10; i++) {
	var position = Point.random() * view.size,
		vector = (Point.random() - [0.5, 0]) * [50, 100],
		ball = new Ball(position, vector);
	balls.push(ball);
}

var textItem = new PointText({
	point: [20, 30],
	fillColor: 'black',
	content: 'Click, drag and release to add balls.'
});

var lastDelta;
function onMouseDrag(event) {
	lastDelta = event.delta;
}

function onMouseUp(event) {
	var ball = new Ball(event.point, lastDelta);
	balls.push(ball);
	lastDelta = null;
}

function onFrame() {
	for (var i = 0, l = balls.length; i < l; i++)
		balls[i].iterate();
}
</script>
<div class="canvas">
<canvas resize="true" id="canvas-1" style="-webkit-user-select: none; touch-action: none; -webkit-user-drag: none; -webkit-tap-highlight-color: rgba(0, 0, 0, 0); background: rgb(242, 242, 242);" width="2432" height="300" data-paper-scope="1" class=""></canvas>
</div>
</div>

<!-- end of bouncing balls --> 
